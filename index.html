<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Competi√ß√£o GG</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: #f9fafb; margin: 0; }
    .main-container { display: flex; min-height: 100vh; }
    .sidebar { width: 280px; background: white; padding: 2rem; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .main-content { flex: 1; padding: 2rem; }
    .user-card { background: linear-gradient(135deg,#0f4c75,#3282b8); color:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem; }
    .user-card h3 { margin:0 0 1rem; }
    .progress-bar { height: 6px; background: rgba(255,255,255,0.3); border-radius:3px; }
    .progress-fill { height:100%; background:#ff6b35; border-radius:3px; width:0%; transition: width .3s; }
    .content-card { background:white; padding:1.5rem; border-radius:12px; box-shadow:0 0 8px rgba(0,0,0,0.05); margin-bottom:2rem; }
    .form-grid { display:grid; grid-template-columns:1fr 2fr 1fr auto; gap:1rem; }
    .btn { padding:0.75rem 1.2rem; border:none; border-radius:8px; cursor:pointer; }
    .btn-primary { background:#0f4c75; color:white; }
    .btn-danger { background:#ef4444; color:white; border-radius:5px; padding:0.4rem 0.7rem; }
    table { width:100%; border-collapse:collapse; margin-top:1rem; }
    th,td { padding:0.8rem; border-bottom:1px solid #e5e7eb; text-align:left; }
    th { background:#f3f4f6; text-transform:uppercase; font-size:0.8rem; }

    /* -------- Responsividade -------- */
    @media (max-width: 768px) {
      .main-container { flex-direction: column; }
      .sidebar { width: 100%; padding: 1rem; display: flex; flex-direction: column; align-items: center; }
      .user-card { width: 100%; margin: 0.5rem 0; }
      .main-content { padding: 1rem; }
      .form-grid { grid-template-columns: 1fr; }
      table, thead, tbody, th, td, tr { display: block; }
      thead tr { display: none; }
      tr { margin-bottom: 1rem; border: 1px solid #e5e7eb; border-radius: 8px; padding: 0.5rem; background: white; }
      td { display: flex; justify-content: space-between; padding: 0.5rem; border: none; }
      td::before { font-weight: bold; color: #555; }
      td:nth-of-type(1)::before { content: "Usu√°rio:"; }
      td:nth-of-type(2)::before { content: "Atividade:"; }
      td:nth-of-type(3)::before { content: "Dura√ß√£o:"; }
      td:nth-of-type(4)::before { content: "Data:"; }
      td:nth-of-type(5)::before { content: "A√ß√£o:"; }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <h2><i class="fas fa-trophy"></i> Competi√ß√£o GG</h2>
      <div class="user-card">
        <h3><i class="fas fa-user"></i> Gustavo</h3>
        <p>Atividades: <span id="gustavoAtividades">0</span></p>
        <p>Tempo total: <span id="gustavoHoras">0.00h</span></p>
        <div class="progress-bar"><div class="progress-fill" id="gustavoProgress"></div></div>
      </div>
      <div class="user-card">
        <h3><i class="fas fa-user"></i> Gabriella</h3>
        <p>Atividades: <span id="gabriellaAtividades">0</span></p>
        <p>Tempo total: <span id="gabriellaHoras">0.00h</span></p>
        <div class="progress-bar"><div class="progress-fill" id="gabriellaProgress"></div></div>
      </div>
    </div>

    <!-- Main -->
    <div class="main-content">
      <div class="content-card">
        <h2><i class="fas fa-plus-circle"></i> Adicionar Nova Atividade</h2>
        <form id="activityForm">
          <div class="form-grid">
            <select id="usuario" required>
              <option value="">Selecionar usu√°rio</option>
              <option value="Gustavo">Gustavo</option>
              <option value="Gabriella">Gabriella</option>
            </select>
            <input type="text" id="atividade" placeholder="Ex: Estudo, Treino..." required>
            <input type="number" id="duracao" min="1" placeholder="30" required>
            <button class="btn btn-primary" type="submit">Adicionar</button>
          </div>
        </form>
      </div>

      <div class="content-card">
        <h2><i class="fas fa-list"></i> Atividades de Hoje</h2>
        <table>
          <thead>
            <tr><th>Usu√°rio</th><th>Atividade</th><th>Dura√ß√£o</th><th>Data</th><th>A√ß√£o</th></tr>
          </thead>
          <tbody id="listaAtividades"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script>
    // üîß Configura√ß√£o do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAtIcz7okyx9lJEV3_97NrSPxh0Uycm-KM",
      authDomain: "competicao-gg.firebaseapp.com",
      projectId: "competicao-gg",
      storageBucket: "competicao-gg.firebasestorage.app",
      messagingSenderId: "695901085155",
      appId: "1:695901085155:web:114fb5728be55c06c2d4d6",
      measurementId: "G-REN540526Y"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const form = document.getElementById("activityForm");
    const listaAtividades = document.getElementById("listaAtividades");

    function getTodayDate() {
  const hoje = new Date();
  const ano = hoje.getFullYear();
  const mes = String(hoje.getMonth() + 1).padStart(2, '0');
  const dia = String(hoje.getDate()).padStart(2, '0');
  return `${ano}-${mes}-${dia}`; // formato YYYY-MM-DD
}

    function atualizarDashboard(atividadesHoje) {
      let stats = { Gustavo: { total:0,count:0 }, Gabriella: { total:0,count:0 }};
      listaAtividades.innerHTML = "";

      atividadesHoje.forEach(doc => {
        const a = doc.data();
        stats[a.usuario].total += a.duracao;
        stats[a.usuario].count++;

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${a.usuario}</td>
          <td>${a.nome}</td>
          <td>${a.duracao} min</td>
          <td>${a.data}</td>
          <td><button class="btn btn-danger" onclick="removerAtividade('${doc.id}')"><i class="fas fa-trash"></i></button></td>
        `;
        listaAtividades.appendChild(row);
      });

      // Atualiza placar
      ["Gustavo","Gabriella"].forEach(u=>{
        document.getElementById(u.toLowerCase()+"Atividades").textContent = stats[u].count;
        document.getElementById(u.toLowerCase()+"Horas").textContent = (stats[u].total/60).toFixed(2)+"h";
        const pct = Math.min((stats[u].total/120)*100,100); // meta fixa: 2h (120min)
        document.getElementById(u.toLowerCase()+"Progress").style.width = pct+"%";
      });
    }

    // Adicionar atividade
    form.addEventListener("submit", async (e)=>{
      e.preventDefault();
      const usuario = document.getElementById("usuario").value;
      const nome = document.getElementById("atividade").value;
      const duracao = parseInt(document.getElementById("duracao").value);
      await db.collection("atividades").add({
        usuario, nome, duracao, data:getTodayDate()
      });
      form.reset();
    });

    // Remover
    async function removerAtividade(id) {
      await db.collection("atividades").doc(id).delete();
    }
    window.removerAtividade = removerAtividade;

    // Listener em tempo real
    db.collection("atividades").where("data","==",getTodayDate())
      .onSnapshot(snapshot=>{
        atualizarDashboard(snapshot.docs);
      });
  </script>
</body>
</html>

